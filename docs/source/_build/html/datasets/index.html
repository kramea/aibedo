<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Datasets &mdash; AIBEDO 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Physics Constraints" href="../physics/index.html" />
    <link rel="prev" title="AIBEDO: a hybrid AI framework to capture the effects of cloud properties on global circulation and regional climate patterns." href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> AIBEDO
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#training-data">Training data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reanalysis">Reanalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing">Preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#constraint-1-climate-energy-budget">Constraint 1. Climate energy budget</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constraint-2-precipitation-energy-budget">Constraint 2. <strong>Precipitation energy budget</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#constraint-3-global-moisture-budget">Constraint 3. <strong>Global moisture budget</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#constraint-4-non-negative-precipitation">Constraint 4. <strong>Non-negative precipitation</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#constraint-5-global-atmospheric-mass-budget">Constraint 5. <strong>Global atmospheric mass budget</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#denormalizing">Denormalizing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../physics/index.html">Physics Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture/index.html">Hybrid AI Model Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dynamics/index.html">Climate Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mcb/index.html">Marine Cloud Brightening</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Code usage and tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reports/index.html">AIBEDO Reports</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AIBEDO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Datasets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/datasets/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="datasets">
<span id="aibedo-datasets"></span><h1>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline"></a></h1>
<section id="training-data">
<h2>Training data<a class="headerlink" href="#training-data" title="Permalink to this headline"></a></h2>
<p>Our training data for Phase 1 consists of a subset of CMIP6 Earth System Model (ESM) outputs which had sufficient data availability on AWS to calculate the requisite input variables for our analysis (shown in Table 1. For each ESM, there are three sets of data hyper-cubes: (a) input, (b) output, and (c) data for enforcing physics constraints. Based on the initial results from our alpha hybrid model, we revised and increased the list of input variables to achieve better hybrid model performance. The updated list of input, output, and constraint variables is shown in Table 2.</p>
<table class="colwidths-given docutils align-default" id="id1">
<caption><span class="caption-text">Table 1. Earth System Model datasets for Phase 1 training</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>N Historical</p></th>
<th class="head"><p>N ssp585</p></th>
<th class="head"><p>Lat spacing (deg)</p></th>
<th class="head"><p>Lon spacing (deg)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CESM2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>0.942</p></td>
<td><p>1.2500</p></td>
</tr>
<tr class="row-odd"><td><p>CESM2-FV2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1.895</p></td>
<td><p>2.5000</p></td>
</tr>
<tr class="row-even"><td><p>CESM2-WACCM</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>0.942</p></td>
<td><p>1.2500</p></td>
</tr>
<tr class="row-odd"><td><p>CESM2-WACCM-FV2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1.895</p></td>
<td><p>2.5000</p></td>
</tr>
<tr class="row-even"><td><p>CMCC-CM2-SR5</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>0.942</p></td>
<td><p>1.2500</p></td>
</tr>
<tr class="row-odd"><td><p>CanESM5</p></td>
<td><p>5</p></td>
<td><p>0</p></td>
<td><p>2.789</p></td>
<td><p>2.8125</p></td>
</tr>
<tr class="row-even"><td><p>E3SM-1-1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1.000</p></td>
<td><p>1.0000</p></td>
</tr>
<tr class="row-odd"><td><p>FGOALS-g3</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>2.278</p></td>
<td><p>2.0000</p></td>
</tr>
<tr class="row-even"><td><p>GFDL-CM4</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1.000</p></td>
<td><p>1.2500</p></td>
</tr>
<tr class="row-odd"><td><p>GFDL-ESM4</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1.000</p></td>
<td><p>1.2500</p></td>
</tr>
<tr class="row-even"><td><p>GISS-E2-1-H</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>2.000</p></td>
<td><p>2.5000</p></td>
</tr>
<tr class="row-odd"><td><p>MIROC-ES2L</p></td>
<td><p>3</p></td>
<td><p>0</p></td>
<td><p>2.789</p></td>
<td><p>2.8125</p></td>
</tr>
<tr class="row-even"><td><p>MIROC6</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1.400</p></td>
<td><p>1.4062</p></td>
</tr>
<tr class="row-odd"><td><p>MPI-ESM-1-2-HAM</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1.865</p></td>
<td><p>1.8750</p></td>
</tr>
<tr class="row-even"><td><p>MPI-ESM1-2-HR</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>0.935</p></td>
<td><p>0.9375</p></td>
</tr>
<tr class="row-odd"><td><p>MPI-ESM1-2-LR</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1.865</p></td>
<td><p>1.8750</p></td>
</tr>
<tr class="row-even"><td><p>MRI-ESM2-0</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1.121</p></td>
<td><p>1.1250</p></td>
</tr>
<tr class="row-odd"><td><p>NorCPM1</p></td>
<td><p>5</p></td>
<td><p>0</p></td>
<td><p>1.9</p></td>
<td><p>2.5</p></td>
</tr>
<tr class="row-even"><td><p>SAM0-UNICON</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>0.942</p></td>
<td><p>1.2500</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id2">
<caption><span class="caption-text">Table 2. Variable list and descriptions</span><a class="headerlink" href="#id2" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>Variable</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Equation notation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Input</p></td>
<td><p>cres</p></td>
<td><p>TOA Cloud radiative effect in shortwave (positive down)</p></td>
<td><p><span class="math notranslate nohighlight">\(R_{TOA}^{cl,SW}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Input</p></td>
<td><p>cresSurf</p></td>
<td><p>Surface Cloud radiative effect in shortwave (positive down)</p></td>
<td><p><span class="math notranslate nohighlight">\(R_{SRF}^{cl,SW}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Input</p></td>
<td><p>crel</p></td>
<td><p>TOA Cloud radiative effect in longwave (positive down)</p></td>
<td><p><span class="math notranslate nohighlight">\(R_{TOA}^{cl,LW}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Input</p></td>
<td><p>crelSurf</p></td>
<td><p>Surface Cloud radiative effect in longwave (positive down)</p></td>
<td><p><span class="math notranslate nohighlight">\(R_{SRF}^{cl,LW}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Input</p></td>
<td><p>netTOAcs</p></td>
<td><p>TOA radiation without clouds (clear-sky) (positive down)</p></td>
<td><p><span class="math notranslate nohighlight">\(R_{TOA}^{cs,ALL}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Input</p></td>
<td><p>netSurfcs</p></td>
<td><p>Net Clearsky Surface radiation and heat flux (positive down)</p></td>
<td><p><span class="math notranslate nohighlight">\(R_{SRF}^{cs,ALL} - SH - LH\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Output</p></td>
<td><p>tas</p></td>
<td><p>2-metre air temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(T_{SRF}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Output</p></td>
<td><p>ps</p></td>
<td><p>Surface pressure</p></td>
<td><p><span class="math notranslate nohighlight">\(p_{SRF}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Output</p></td>
<td><p>pr</p></td>
<td><p>Precipitation</p></td>
<td><p><span class="math notranslate nohighlight">\(P\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Constraint</p></td>
<td><p>evspsbl</p></td>
<td><p>Evaporation</p></td>
<td><p><span class="math notranslate nohighlight">\(E\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Constraint</p></td>
<td><p>hfss</p></td>
<td><p>Surface upward sensible heat flux (positive up)</p></td>
<td><p><span class="math notranslate nohighlight">\(SH\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Constraint</p></td>
<td><p>netTOARad</p></td>
<td><p>TOA All-sky radiation (positive down)</p></td>
<td><p><span class="math notranslate nohighlight">\(R_{TOA}^{all,ALL}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Constraint</p></td>
<td><p>netSurfRad</p></td>
<td><p>Surface All-sky radiation (positive down)</p></td>
<td><p><span class="math notranslate nohighlight">\(R_{TOA}^{all,ALL}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Constraint</p></td>
<td><p>qtot</p></td>
<td><p>Column integrated water vapour mass</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{g}\sum_{lev} Q dp\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Constraint</p></td>
<td><p>dqdt</p></td>
<td><p>Time tendency of column integrated water vapour mass</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{g}\frac{d}{dt} \sum_{lev} Q dp\)</span></p></td>
</tr>
</tbody>
</table>
<p>The ESM data are pooled together to form the training and testing datasets for our hybrid model. However, it is important to note there are substantial differences in the climatologies and variability of some of the chosen input variables across models (Figure 1). In particular, global average cloud liquid water content, cloud ice water content, and net top of atmosphere radiation vary more across ESMs than other variables. The former two are the result of differences in cloud parameterizations between ESMs, while the latter is likely due to uncertainties in the overall magnitude of anthropogenic forcing over the historical period. Comparing spatial correlation scores (Figure 2), shows net TOA radiation fields are very similar across models while the spatial pattern of cloud ice and water content varies substantially. Such variations represent the inter-ESM uncertainty in the representation of the climate. However, many of these ESM differences are largely removed during preprocessing described below.</p>
<figure class="align-default" id="id3">
<img alt="../_images/box_mm_spread_1.png" src="../_images/box_mm_spread_1.png" />
<figcaption>
<p><span class="caption-text">Figure 1. Box plot of spread of ESM global and time means of selected input, output, and constraint variables divided by their respective multi-model ensemble mean. Ensemble mean values shown in parentheses in the x-labels</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id4">
<img alt="../_images/model_var_spatcorr_2.png" src="../_images/model_var_spatcorr_2.png" />
<figcaption>
<p><span class="caption-text">Figure 2. Pearson-R spatial correlations between ESM time average and ESM ensemble mean fields (for data remapped to level 5 Sphere-Icosahedral grid) across the models (rows) and variables (columns), showing the inter-ESM uncertainty in the climatologies of the selected input, output, and constraint variables</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="reanalysis">
<h2>Reanalysis<a class="headerlink" href="#reanalysis" title="Permalink to this headline"></a></h2>
<p>In addition to ESM data, we also employ “reanalysis” datasets as validation datasets. Namely the <a class="reference external" href="https://gmao.gsfc.nasa.gov/reanalysis/MERRA-2/">Modern-Era Retrospective analysis for Research and Applications, Version 2 (MERRA2)</a> and the <a class="reference external" href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5">ECMWF Reanalysis version 5 (ERA5)</a>.
Reanalyses are models which ingest large quantities observational data to estimate the historical evolution of the atmosphere, thus providing an estimate of a wide range of atmospheric variables over the entire globe.
While these data are exactly the same as observational data, they are the best method of obtaining physically consistent and complete climate data representing the recent past of the Earth’s atmosphere.
MERRA2 includes data from 1980 to 2020 at 0.5 degree resolution and ERA5 includes data from 1979 to 2021 at 0.25 degree resolution.</p>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline"></a></h2>
<p>Each of the above data hyper-cubes are preprocessed before ingestion into the hybrid model as follows:</p>
<ol class="arabic simple">
<li><p><strong>Remove seasonal cycle or “Deseasonalizing”</strong>: We perform this process to remove any trends in the season to prepare a seasonal stationary time series data.</p></li>
<li><p><strong>Remove trend or Detrend</strong>: We fit a third degree polynomial to remove any trend in data over time. This removes secular trends (for example, rising temperatures as atmospheric CO$_2$ increases) and allows the model to be trained on fluctuations due to internal variability, rather than the forced response.</p></li>
<li><p><strong>Normalized anomalies</strong>: The anomaly at each grid point is calculated relative to a running mean that is computed over a centered 30-year window for that grid point and month. Anomalies are normalized by dividing by the standard deviation of the anomaly over the same 30-year window for that grid point and month.</p></li>
<li><p><strong>Remap data to Sphere-Icosahedral</strong>: Use <a class="reference external" href="https://code.mpimet.mpg.de/projects/cdo/embedded/index.html#x1-6460002.12.1">Climate Data Operators</a> to bilinearly remap disparate ESM grids to uniform level-6 Sphere-Icosahedral grid.</p></li>
</ol>
<figure class="align-default" id="id5">
<img alt="../_images/preprocessing_example.png" src="../_images/preprocessing_example.png" />
<figcaption>
<p><span class="caption-text">Figure 3. Example preprocessing for a surface air temperature data point.</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
Physics Constraints
——————–</p>
<p>To strengthen the generalisability of the AiBEDO model, we include “weak” physics-based constraints on the output to penalize unphysical results from the model.</p>
<section id="constraint-1-climate-energy-budget">
<h3>Constraint 1. Climate energy budget<a class="headerlink" href="#constraint-1-climate-energy-budget" title="Permalink to this headline"></a></h3>
<p>In this constraint, the energy is budgeted between the heat storage and radiative fluxes at TOA on timescales over which atmospheric energy storage is minimal. This constraint is related to the energy budget used to calculate the transient climate sensitivity (e.g. Bitz et al., 2012).</p>
<div class="math notranslate nohighlight">
\[\sum_{t}^{&gt; 1 yr} \sum_{lat=90S}^{90N}\sum_{lon=180W}^{180E}(\Delta {R^{TOA}_{lat, lon}} - \lambda_{ECS}\Delta T_{lat, lon}\Delta A_{lat, lon}) = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta R^{TOA}\)</span> is heat storage/top of atmosphere radiative imbalance, <span class="math notranslate nohighlight">\(\lambda_{ECS}\)</span> feedback constant, <span class="math notranslate nohighlight">\(T\)</span> is surface temperature and <span class="math notranslate nohighlight">\(A\)</span> is the area of the cell.
For the <span class="math notranslate nohighlight">\(\lambda_{ECS}\)</span> feedback constant, we use the CESM2 equilibrium feedback computed from a 2xCO<sub>2</sub> simulation.
The Planck, water vapour, cloud, and albedo feedbacks are provided as seasonally varying zonal averages.
We sum all the feedback components together, map across longitude values, and then interpolate to the Sphere-Icosahedral grid.
Constraint 1 applies over longer time scales than the other constraints thus requires several months of data to compute.
Note also that we are applying the feedback parameter <span class="math notranslate nohighlight">\(\lambda_{ECS}\)</span> from one ESM (CESM2) regardless of the source of the training data.
This weakens the constraint as there is significant uncertainty within CMIP6 in the magnitude of the feedback parameter (Zelinka et al., 2020).</p>
</section>
<section id="constraint-2-precipitation-energy-budget">
<h3>Constraint 2. <strong>Precipitation energy budget</strong><a class="headerlink" href="#constraint-2-precipitation-energy-budget" title="Permalink to this headline"></a></h3>
<p>This is the energetic constraint on global precipitation. Annual mean global precipitation changes are constrained by this relationship. Globally averaged annual mean radiative cooling of the atmosphere must be balanced by latent heat flux due to condensation and sensible heat flux from the surface (Allen and Ingram, 2002; Jakob et al., 2019).</p>
<div class="math notranslate nohighlight">
\[\sum_{t}^{ 1 yr} \sum_{lat=90S}^{90N}\sum_{lon=180W}^{180E}(\Delta LP + \Delta SH) = \sum_{t}^{ 1 yr} \sum_{lat=90S}^{90N}\sum_{lon=180W}^{180E}(\Delta R_{TOA} - \Delta R_{SFC})\]</div>
<p>This can be written as -</p>
<div class="math notranslate nohighlight">
\[\sum_{t}^{ 1 yr} \sum_{lat=90S}^{90N}\sum_{lon=180W}^{180E}(\Delta LP + \Delta SH - \Delta R_{TOA} + \Delta R_{SFC}) = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is the latent heat of vaporization (<span class="math notranslate nohighlight">\(2.4536 10^6\)</span> J/kg), <span class="math notranslate nohighlight">\(P\)</span> is the precipitation, <span class="math notranslate nohighlight">\(SH\)</span> is the sensible heat flux, <span class="math notranslate nohighlight">\(R_{TOA}\)</span> is the upwelling TOA radiation, <span class="math notranslate nohighlight">\(R_{SFC}\)</span> is the upwelling surface radiation. <span class="math notranslate nohighlight">\(\Delta\)</span> represents anomalies of respective variable.</p>
</section>
<section id="constraint-3-global-moisture-budget">
<h3>Constraint 3. <strong>Global moisture budget</strong><a class="headerlink" href="#constraint-3-global-moisture-budget" title="Permalink to this headline"></a></h3>
<p>This relationship balances the moisture flux in to (evaporation) and out of (precipitation) the atmosphere with the change in atmospheric moisture content over the globe at each time step, thus ensuring conservation of moisture in the atmosphere.</p>
<div class="math notranslate nohighlight">
\[\sum_{lat=90S}^{90N} \sum_{lon=180W}^{180E} (P-E)_{lat,lon} \Delta A_{lat,lon} = \int_{lat=90S}^{90N} \int_{lon=180W}^{180E} \frac{-1}{g}\frac{\partial}{\partial t} \sum_{lev = 0}^{p_s} q_{lev,lat,lon} dp \Delta A_{lat,lon}\]</div>
<p>where <span class="math notranslate nohighlight">\(P\)</span> is the precipitation, <span class="math notranslate nohighlight">\(E\)</span> is the evaporation, <span class="math notranslate nohighlight">\(q\)</span> is the specific humidity, and <span class="math notranslate nohighlight">\(p_s\)</span> is the surface pressure.</p>
<p>Currently, we approximate the moisture storage term as the climatological mean global mean P-E, which we subtract from the P-E we calculate for a given month of AiBEDO output such that</p>
<div class="math notranslate nohighlight">
\[\sum_{lat=90S}^{90N} \sum_{lon=180W}^{180E} (P-E)_{lat,lon} \Delta A_{lat,lon} - \epsilon_q \approx 0\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon_q\)</span> is the climatological <span class="math notranslate nohighlight">\(\sum_{lat=90S}^{90N} \sum_{lon=180W}^{180E} (P-E)_{lat,lon} \Delta A_{lat,lon}\)</span></p>
</section>
<section id="constraint-4-non-negative-precipitation">
<h3>Constraint 4. <strong>Non-negative precipitation</strong><a class="headerlink" href="#constraint-4-non-negative-precipitation" title="Permalink to this headline"></a></h3>
<p>A simple yet relevant constraint is to ensure negative precipitation (<span class="math notranslate nohighlight">\(P\)</span>) values are set to zero during model training. This will then ensure maximum penalty for the erring grid point when compared to the ground truth data.</p>
<div class="math notranslate nohighlight">
\[P \ge 0, lat \in [90S, 90N], lon \in [180E, 180W]\]</div>
</section>
<section id="constraint-5-global-atmospheric-mass-budget">
<h3>Constraint 5. <strong>Global atmospheric mass budget</strong><a class="headerlink" href="#constraint-5-global-atmospheric-mass-budget" title="Permalink to this headline"></a></h3>
<p>Using the hydrostatic balance assumption, surface pressure can be used as a proxy for the mass of the atmosphere. This simple constraint ensures atmospheric mass conservation summed over the globe for monthly mean data.</p>
<div class="math notranslate nohighlight">
\[\sum_{lat=90S}^{90N}\sum_{lon=190W}^{180E}(P_s)_{lat,lon} \Delta A_{lat, lon} = C + \Delta t\sum_{lat=90S}^{90N}\sum_{lon=190W}^{180E}(M)_{lat,lon} \Delta A_{lat, lon}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_s\)</span> is the surface pressure and <span class="math notranslate nohighlight">\(M\)</span> is the mass flux into the atmosphere. We assume that the mass flux into the atmosphere is predominantly water vapour, such that we can assume <span class="math notranslate nohighlight">\(M = P - E\)</span> and the constant <span class="math notranslate nohighlight">\(C\)</span> is the mass of the dry atmosphere.</p>
<p>The time integrated <span class="math notranslate nohighlight">\(P-E\)</span> is equivalent to the mass of water vapour in the atmosphere, which we estimate as</p>
<div class="math notranslate nohighlight">
\[M_Q = \int_{lat=90S}^{90N} \int_{lon=180W}^{180E} \frac{-1}{g} \sum_{lev = 0}^{p_s} q_{lev,lat,lon} dp\]</div>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[\sum_{lat=90S}^{90N}\sum_{lon=190W}^{180E}(P_s)_{lat,lon} \Delta A_{lat, lon} = C + g M_Q\]</div>
<p>Similar to constraint 3, we currently assume some <span class="math notranslate nohighlight">\(C + M_q\)</span> can be approximated by the climatological mean <span class="math notranslate nohighlight">\(P_s\)</span>, which we subtract from the <span class="math notranslate nohighlight">\(P_s\)</span> for a given month of AiBEDO output such that</p>
<div class="math notranslate nohighlight">
\[\int_A \frac{-1}{g}p_s dA - (C + \epsilon_E) = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(C + \epsilon_E\)</span> is the climatological average of <span class="math notranslate nohighlight">\(\int_A \frac{-1}{g}p_s dA\)</span>.</p>
</section>
<section id="denormalizing">
<h3>Denormalizing<a class="headerlink" href="#denormalizing" title="Permalink to this headline"></a></h3>
<p>As the AiBEDO model deals with normalized variables while the constraint require the variables in their original units (and with physically realistic spatial variations), we must “denormalize” the model output to apply the constraints.
The training data fed into the model is detrended and deseasonalized, thus filtering out all low frequency information. However, the climatology and variability change as anthropogenic climate change intensifies.
Furthermore, the data is derived from a range of models with differing mean climatology and interannual variability patterns.
Thus, passing through the climatology and variability associated with the model and time period of training time step provides additional information about model uncertainty and GHG forced climate change that is undesirable when training in a Fluctuation Dissipation framework.
As a result, we select a single reference climatology and variability with which to denormalize the model output for calculating constraints.
This reference can thus be thought to represent the climatology and variability of the AiBEDO model.</p>
<p>We select the CMIP6 multi-ESM ensemble average climatology and variability for the denormalization (though we might equally consider using reanalysis data).
The average variability is computed as the square root of the average of the interannual variances across the ESMs.
Note that we must still deal with a seasonal cycle in the climatology. A simple approach is to use a single month or season as the basis for the denormalization. More sophisticated methods of incorporating seasonal information are currently under consideration.</p>
<figure class="align-default" id="id6">
<img alt="../_images/CMIP6_tas_pr_evap_MMmean.png" src="../_images/CMIP6_tas_pr_evap_MMmean.png" />
<figcaption>
<p><span class="caption-text">Figure 4. March climatology and interannual variability in the CMIP6 multi-model average.</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline"></a></h2>
<p>Allen, M. R., &amp; Ingram, W. J. (2002). Constraints on future changes in climate and the hydrologic cycle. Nature, 419(6903), 228-232.</p>
<p>Bitz, C. M., Shell, K. M., Gent, P. R., Bailey, D. A., Danabasoglu, G., Armour, K. C., Holland M. M. &amp; Kiehl, J. T. (2012). Climate sensitivity of the community climate system model, version 4. Journal of Climate, 25(9), 3053-3070.</p>
<p>Jakob, C., Singh, M. S., &amp; Jungandreas, L. (2019). Radiative convective equilibrium and organized convection: An observational perspective. Journal of Geophysical Research: Atmospheres, 124(10), 5418-5430.</p>
<p>Muller, C. J., &amp; O’Gorman, P. A. (2011). An energetic perspective on the regional response of precipitation to climate change. Nature Climate Change, 1(5), 266-271.</p>
<p>Zelinka, M. D., Myers, T. A., McCoy, D. T., Po‐Chedley, S., Caldwell, P. M., Ceppi, P., Klein, S.A. &amp; Taylor, K. E. (2020). Causes of higher climate sensitivity in CMIP6 models. Geophysical Research Letters, 47(1), e2019GL085782.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="AIBEDO: a hybrid AI framework to capture the effects of cloud properties on global circulation and regional climate patterns." accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../physics/index.html" class="btn btn-neutral float-right" title="Physics Constraints" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Ramea.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>